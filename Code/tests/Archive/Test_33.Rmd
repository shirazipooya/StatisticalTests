---
title: "Test 33: The w/s-test for Normality of a Population"
output:
  word_document:
    highlight: "default"
    reference_docx: word_styles.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Step_1, warning=FALSE, message=FALSE}
# Load Required Functions:
source(file = "muFunc.R")

# Load Required Packages:
wants <- c("dplyr", "psych", "pacman", "ggpubr",
           "PerformanceAnalytics", "lubridate", "DescTools")
has <- wants %in% rownames(x = installed.packages())
if(any(!has)) install.packages(wants[!has])
pacman::p_load(char = wants)

# Load Required Data:
data <- read.csv(file = "data/Data_Test_33.csv", header = TRUE)

set.seed(1)
sampleData = data %>% 
  sample_n(size = 15)

# Show Data:
headTail(x = data, top = 2, bottom = 2)
```

```{r Step_2, fig.width=4, fig.height=4, dpi=600}
# Assumption Checking:
# Use Shapiro-Wilk Normality Test:
shapiro.test(x = data$PRCP)

# Normality Plot:
ggqqplot(data = data$PRCP, ylab = "Prec. (mm)")

# Visualize Data Using Scatter Plots:
data %>% ggdensity(x = "PRCP", fill = "gray",
                   xlab = "Precipitation (mm)", add = c("mean"))
```

```{r Step_3, fig.width=4, fig.height=4, dpi=600}
# Method 1:---------------------------------------------------------------------
# Input data
set.seed(1)
sample1 = data %>% sample_n(size = 25)

n1 = nrow(sample1)

# Sample Standard Deviation (s)
s1 = sd(x = sample1$PRCP)

# Sample Range (w)
w1Range = range(sample1$PRCP)
w1 = w1Range1[2] - w1Range[1]

# Test Statistic
q1 = w1 / s1

# Critical Values
cv_table = read.csv(file = "data/Table_14.csv", header = TRUE)
cv = cv_table %>% filter(n == n1) %>% select(a05, b05)

if (q1 < cv[["a05"]] & q1 > cv[["b05"]]) {
  cat("Reject The Null Hypothesis (H0) Of Equal Medians At α = 0.05", "\n")
} else {
  cat("Accept The Null Hypothesis (H0) Of Equal Medians At α = 0.05", "\n")
}

# Method 2:---------------------------------------------------------------------
# The Sign Test for a Median with "SignTest" function from "DescTools" package

```
