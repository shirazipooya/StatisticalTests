---
title: "Test 14: Z-test for Two Correlation Coefficients"
output:
  word_document:
    highlight: "default"
    reference_docx: word_styles.docx
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Step_1, warning=FALSE, message=FALSE}
# Load Required Functions:
source(file = "muFunc.R")

# Load Required Packages:
wants <- c("dplyr", "psych", "pacman", "ggpubr",
           "PerformanceAnalytics", "miscor", "EnvStats")
has <- wants %in% rownames(x = installed.packages())
if(any(!has)) install.packages(wants[!has])
pacman::p_load(char = wants)

# Load Required Data:
data <- read.csv(file = "data/Data_Test_24.csv", header = TRUE)

# Show Data:
headTail(x = data)
```

```{r Step_2, fig.width=4, fig.height=4, dpi=600}
# Assumption Checking:
# 1. It is assumed that the sample is taken from a normal population.

# Use Shapiro-Wilk Normality Test:
shapiro.test(x = data$Yield)

# Normality Plot:
ggqqplot(data = data$Yield, ylab = "Yield (kg/ha)")

# Visualize Data Using Density Plot:
ggdensity(data = data, x = "Yield", fill = "gray",
          xlab = "Yield (kg/ha)", add = c("mean"))
```

```{r Step_3}
# Method 1:---------------------------------------------------------------------
# Setting Initial Parameter Values:
x = data$Yield
x_bar = mean(x = x)
n = length(x = x)
sigma0_2 = 700 ^ 2

# Sample Variance
s_2 = (sum((x - x_bar) ^ 2)) / (n - 1)

# Test Statistic
chi_2 = (s_2 / sigma0_2) * (n - 1)

# Compute the critical values at 0.05 significance level (two tailed).
alpha = 0.05
chi.a = qchisq(p = (1 - alpha/2), df = n - 1, lower.tail = FALSE)
chi.b = qchisq(p = (1 - alpha/2), df = n - 1, lower.tail = TRUE)

# P-value for Spearman's rank correlation coefficient (Two Tailed).
p_value = 2 âˆ— (1 - pchisq(q = chi_2, df = n - 1))

cat("chi-score: ", chi_2, "\n")
cat("Critical values: ", c(chi.a, chi.b), "\n")
cat("P-value: ", p_value, "\n")

plotDistStat(dist = "Chi-Squared",
             df = n - 1,
             from = 0,
             to = 50,
             alpha_level = 0.05,
             statistic_point = chi_2,
             p_value = p_value)

# Method 2:---------------------------------------------------------------------
# use "varTest" function from "EnvStats" package 
varTest(x = x, sigma.squared = sigma0_2,
        alternative = "two.sided", conf.level = 0.95)

```

